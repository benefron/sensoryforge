pipeline:
  grid_size: 80
  spacing: 0.15
  center: [0.0, 0.0]
  filter_method: multi_step
  device: cpu
  seed: 42

innervation:
  sa:
    neurons_per_row: null  # Auto-determined from grid
    connections_per_neuron: 28
    sigma_d_mm: 0.3
    weight_range: [0.5, 1.5]
    edge_offset: null
  ra:
    neurons_per_row: null  # Auto-determined from grid  
    connections_per_neuron: 28
    sigma_d_mm: 0.3
    weight_range: [0.5, 1.5]
    edge_offset: null

neurons:
  sa_neurons: 100
  ra_neurons: 196
  dt: 0.1

noise:
  membrane_amplitude: 0.1
  receptor_amplitude: 0.1

stimulus:
  default_type: gaussian
  parameters:
    gaussian:
      sigma_x: 0.3
      sigma_y: 0.3
      magnitude: 1.0
    point:
      radius: 0.3
      magnitude: 1.0
    edge:
      edge_length: 1.0
      magnitude: 1.0

# -----------------------------------------------------------------------------
# Analysis & decoding sweep parameters (formerly config/pipeline_config.yml)
# -----------------------------------------------------------------------------

grid:
  size: 40
  spacing_mm: 0.15

populations:
  sa:
    neuron_counts: [81, 100, 196, 256, 400, 576, 784, 900, 1089, 1600, 2025]
    sigma_range: [0.05, 0.35]
    mean_inn_range: [20, 60]
    temporal_filter:
      method: multi_step
      dt_seconds: 0.0005
  ra:
    neuron_counts: [81, 100, 196, 256, 400, 576, 784, 900, 1089, 1600, 2025]
    sigma_range: [0.05, 0.35]
    mean_inn_range: [20, 60]
    temporal_filter:
      method: multi_step
      dt_seconds: 0.0005
  unfiltered:
    neuron_counts: [100, 196, 256, 400, 576, 784, 900, 1089, 1600, 2025]
    sigma_range: [0.075, 0.3]
    mean_inn_range: [20, 60]

ridge_lambda_grid: [0.0, 1.0e-4, 3.0e-4, 1.0e-3, 3.0e-3, 1.0e-2, 3.0e-2, 1.0e-1]

receptor_weight_range: [0.1, 1.0]

sampling:
  method: sobol
  coarse_samples_per_count: 32
  sobol_seed: 123

timing:
  dt_seconds: 0.0005

filters:
  sa:
    tau_r: 5.0
    tau_d: 30.0
    k1: 0.05
    k2: 3.0
    dt_ms: 0.5
  ra:
    tau_RA: 15.0
    k3: 2.0
    dt_ms: 0.5

stimuli:
  - id: gaussian_sigma_0_3_static
    type: gaussian
    center_x: 0.0
    center_y: 0.0
    sigma: 0.3
    amplitude: 1.0
    time_steps: 600
    temporal_profile:
      kind: ramp
      up_steps: 60
      down_steps: 60
  - id: gaussian_sigma_1_4_static
    type: gaussian
    center_x: -0.9
    center_y: 0.7
    sigma: 1.4
    amplitude: 1.0
    time_steps: 600
    temporal_profile:
      kind: ramp
      up_steps: 80
      down_steps: 80
  - id: edge_diagonal_sweep
    type: edge
    theta: 0.78539816339
    w: 0.3
    amplitude: 1.0
    time_steps: 600
    motion:
      kind: path
      coordinates:
        - [-4.0, -4.0]
        - [4.0, 4.0]
    temporal_profile:
      kind: ramp
      up_steps: 80
      down_steps: 80
  - id: edge_corner_sweep
    type: edge
    theta: -0.78539816339
    w: 0.3
    amplitude: 1.0
    time_steps: 800
    motion:
      kind: path
      coordinates:
        - [-0.0, 0.0]
        - [0.0, -0.0]
    temporal_profile:
      kind: ramp
      up_steps: 80
      down_steps: 80
  - id: edge_grating_sweep
    type: edge_grating
    theta: 1.57079632679
    spacing: 0.45
    count: 7
    w: 0.08
    amplitude: 1.0
    center_x: 0.0
    center_y: 0.0
    time_steps: 600
    motion:
      kind: horizontal
      span: 6.0
    temporal_profile:
      kind: ramp
      up_steps: 80
      down_steps: 80

fusion:
  default_mode: receptor
  receptor_weights: [0.5, 0.5]

metrics:
  data_range: 1.0
  weights:
    spatial:
      spatial_mse: 0.30
      spatial_ssim: 0.30
      spatial_r2: 0.20
      spatial_com_shift: 0.20
    temporal:
      temporal_mse: 0.30
      temporal_corr: 0.30
      temporal_ssim: 0.20
      spectral_entropy_delta: 0.20
    global:
      normalized_mutual_info: 1.0
    combined:
      spatial: 0.40
      temporal: 0.40
      global: 0.20

outputs:
  root_dir: analysis_results
  overwrite: false

bayesian_estimator:
  dynamics:
    model: "random_walk" # or "ar1", "constant_velocity"
    rho: 0.95
  noise:
    process_cov_scale: 1e-4
    measurement_cov_scale: 0.1
  initialization:
    P0_scale: 1.0

# -----------------------------------------------------------------------------
# Bayesian Estimator Configuration
# -----------------------------------------------------------------------------
bayesian_estimator:
  dynamics:
    model: "random_walk" # or "ar1"
    rho: 0.95
  noise:
    process_cov_scale: 1.0e-4
    measurement_cov_scale: 0.1
  initialization:
    P0_scale: 1.0
  priors:
    spatial_sigma: 0.0
